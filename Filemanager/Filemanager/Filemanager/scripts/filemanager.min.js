(function(n){function oi(n){var t=this.window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!t)throw new Error("XMLHttpRequest not supported");return(t.open("HEAD",n,!1),t.send(null),t.status==200)?!0:!1}function h(t,i){return t["File Type"]=="dir"&&(i=="download"||i=="replace")?!1:typeof t.Capabilities=="undefined"?!0:n.inArray(i,t.Capabilities)>-1}function y(t){var r=t.attr("class").replace(/ /g,"_"),i;return r==""?"itemOptions":(n("#"+r).length||(i=n("#itemOptions").clone().attr("id",r),t.hasClass("cap_select")||n(".select",i).remove(),t.hasClass("cap_download")||n(".download",i).remove(),t.hasClass("cap_rename")||n(".rename",i).remove(),t.hasClass("cap_move")||n(".move",i).remove(),n(".replace",i).remove(),t.hasClass("cap_delete")||n(".delete",i).remove(),n("#itemOptions").after(i)),r)}function ur(n){this.prefix=n;this.num=1;this.getID=function(){return this.prefix+this.num++}}function or(n){var t=[].slice.call(arguments,1),i=0;return n.replace(/%s/g,function(){return t[i++]})}function c(n){if(n=new RegExp("[?&]"+encodeURIComponent(n)+"=([^&]*)").exec(location.search))return decodeURIComponent(n[1])}function sr(n){var t=/(^(__.____)|^(__.__.____)|^(01.4000)|^(01.01.4000)|^(((0[1-9]|[12]\d|3[01])[.]{1}(0[13578]|1[02])[.]{1}((19\d{2})|([2-3]{1}\d{3})))|((0[1-9]|[12]\d|30)[.]{1}(0[13456789]|1[012])[.]{1}((19\d{2})|([2-3]{1}\d{3})))|((0[1-9]|1\d|2[0-8])[.]{1}02[.]{1}((19\d{2})|([2-3]{1}\d{3})))|(29[.]{1}02[.]{1}((19|[2-3]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00)))))(\s0:00:00)?/.exec(n);return t!=null&&t[0]==n}function st(i,r,u){var o=0,f={},s=!1,e;for(key in i)o==r&&(f=i[key],s=!0),o++;s&&(f.Code==-1?(e={},e[t.no]="false,"+f.File,e[t.yes]="true,"+f.File,n.prompt(or(t.FILE_ALREADY_EXISTS,f.File),{buttons:e,callback:function(n){if(n.split(",")[0]=="false")for(var t=0;t<u.files.length;t++)u.files[t].name==n.split(",")[1]&&u.removeFile(u.files[t]);r=r+1;st(i,r,u)}})):(r=r+1,st(i,r,u)))}function hr(){var n=window.navigator.userAgent,t=n.indexOf("MSIE ");return t>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)?!0:!1}function ui(){var i,f;if(r.options.searchBox===!0?n.getScript("./scripts/filemanager.liveSearch.js"):n("#search").remove(),n("#file-input-container").hide(),n("#upload").hide(),n("#uploadFlash").show(),n("#uploadFlash").click(function(){s(n("#currentpath").val());var i={};i[t.close]=function(){n("#dialog").dialog("close")};n("#dialog").dialog({width:600,height:470,title:t.dialod_upload,modal:!0,closeOnEscape:!0,position:"center",buttons:i,show:"drop",hide:{effect:"drop",direction:"right"},close:function(){n("#form_validate").validate().resetForm()},open:function(){var i="";for(ext in r.security.uploadRestrictions)i+=r.security.uploadRestrictions[ext]+",";i=i.substr(0,i.length-2);n("#file_upload").pluploadQueue({runtimes:"html5,flash,silverlight,html4",url:"/Filemanager/connectors/ashx/filemanager.ashx?currentpath="+encodeURIComponent(n("#currentpath").val())+"&user_id="+encodeURIComponent(n("#user_id").text())+"&user_create="+encodeURIComponent(n("#user_create").val())+"&date_document="+encodeURIComponent(n("#date_document").val())+"&mode=addFlash",rename:!0,dragdrop:!0,filters:{max_file_size:"100000mb",mime_types:[{title:"All files",extensions:i}]},flash_swf_url:"/Filemanager/plupload/js/Moxie.swf",silverlight_xap_url:"/Filemanager/plupload/js/Moxie.xap",preinit:{UploadComplete:function(){v()},FileUploaded:function(upldr,file,result){var data=eval("("+result.response+")");data.Code==-2&&(n.prompt(t.ERROR_RENAMING_DIRECTORY),n("#update").trigger("click"))}},init:{FilesAdded:function(t,i){var r="",u,f;for(u in i)r=r+i[u].name+",";r=r.substr(0,r.length-1);f="/Filemanager/connectors/ashx/filemanager.ashx?currentpath="+encodeURIComponent(n("#currentpath").val())+"&user_id="+n("#user_id").val()+"&mode=rewriteNoFlash";n.ajax({type:"POST",url:f,data:{fileNames:r},async:!1,success:function(result){var newData=eval("("+result+")");st(newData,0,t)}})}}})},create:function(){}})}),r.options.useFileTable&&(n("#form_validate").validate(),i="<table><tr><td>",i+=t.user+": <\/td><td><div id='user_id'>",i+=c("user_id")+"<\/div><\/td><tr><td>",i+=t.user_create_document+": <\/td><td><input type='text' id='user_create'/><\/td><\/tr><tr><td>",i+=t.date_document+": <\/td><td><input type='text' id='date_document' class='date_document'/><div><label class='error' for='date_document' /><\/div><\/td>",i+="<\/tr><\/table>",n("#attr_info").html(i)),n.validator.addMethod("date_document",function(n){return sr(n)||n==""?!0:!1},"Невірний формат дати"),intitDatepicker("date_document",t.date_document),n("#OpenTree").hide(),r.extras.extra_js)for(f=0;f<r.extras.extra_js.length;f++)n.ajax({url:r.extras.extra_js[f],dataType:"script",async:r.extras.extra_js_async});r.edit.enabled&&(loadCSS("./scripts/CodeMirror/lib/codemirror.css"),loadCSS("./scripts/CodeMirror/theme/"+r.edit.theme+".css"),loadJS("./scripts/CodeMirror/lib/codemirror.js"),loadJS("./scripts/CodeMirror/addon/selection/active-line.js"),loadJS("./scripts/CodeMirror/dynamic-mode.js"));relPath=r.options.relPath===!1?window.location.protocol+"//"+window.location.host:r.options.relPath;n.urlParam("exclusiveFolder")!=0&&(fileRoot+=n.urlParam("exclusiveFolder"),fileRoot.charAt(fileRoot.length-1)!="/"&&(fileRoot+="/"),fileRoot=fileRoot.replace(/\/\//g,"/"));n.urlParam("expandedFolder")!=0?(expandedFolder=n.urlParam("expandedFolder"),fullexpandedFolder=fileRoot+expandedFolder):(expandedFolder="",fullexpandedFolder=null);r.options.autoload==!0&&(n("#upload").append(t.upload),n("#uploadFlash").append(t.upload),n("#newfolder").append(t.new_folder),n("#grid").attr("title",t.grid_view),n("#list").attr("title",t.list_view),n("#fileinfo h1").append(t.select_from_left),n('#itemOptions a[href$="#select"]').append(t.select),n('#itemOptions a[href$="#edit"]').append(t.editFile),n('#itemOptions a[href$="#download"]').append(t.download),n('#itemOptions a[href$="#rename"]').append(t.rename),n('#itemOptions a[href$="#move"]').append(t.move),n('#itemOptions a[href$="#replace"]').append(t.replace),n('#itemOptions a[href$="#delete"]').append(t.del));n.urlParam("CKEditorCleanUpFuncNum")&&(n("body").append('<button class="button" id="close-btn" type="button">'+t.close+"<\/button>"),n("#close-btn").click(function(){parent.CKEDITOR.tools.callFunction(n.urlParam("CKEditorCleanUpFuncNum"))}));n("#browse").append("+");n("#browse").attr("title",t.browse);n("#newfile").change(function(){n("#filepath").val(n(this).val().replace(/.+[\\\/]/,""))});n("button").wrapInner("<span><\/span>");n("#fileinfo").data("view",r.options.defaultViewMode);d(r.options.defaultViewMode);n("#OpenTree").click(function(){n("#CloseTree").show();n("#OpenTree").hide();var t=n("#fileinfo").data("view");n("#fileinfo").data("view",t);u==null?a():(n("#filetree").find("ul>li.collapsed>a").trigger("openTree"),s(fileRoot))});n("#pen").attr("title",t.search_name);n("#people").attr("title",t.search_people);n("#update").attr("title",t.update);n("#OpenTree").attr("title",t.open_tree);n("#CloseTree").attr("title",t.close_tree);n("#pen").click(function(){n("#people").show();n("#pen").hide();ft=!1;n("#q").liveUpdate("#filetree ul",2).blur()});n("#people").click(function(){n("#people").hide();n("#pen").show();ft=!0;n("#q").liveUpdate("#filetree ul",1).blur()});n("#CloseTree").click(function(){n("#CloseTree").hide();n("#OpenTree").show();var t=n("#fileinfo").data("view");n("#fileinfo").data("view",t);n("#filetree>ul>li.expanded>a").trigger("closeTree");s(fileRoot)});n("#update").click(function(){k&&(k=!1,u=null,Update=!0,a())});n("#home").click(function(){var t=n("#fileinfo").data("view");n("#fileinfo").data("view",t);n("#filetree>ul>li.expanded>a").trigger("closeTree");s(fileRoot)});n("#grid").click(function(){d("grid");n("#fileinfo").data("view","grid");s(n("#currentpath").val())});n("#list").click(function(){d("list");n("#fileinfo").data("view","list");s(n("#currentpath").val())});r.options.showButtonMode||(n("#client").hide(),n("#server").hide());n("#client").click(function(){n("#client").hide();n("#server").show();r.options.serverMode=!0;n("#CloseTree").hide();n("#OpenTree").hide();n("#update").trigger("click");n("#home").trigger("click")});n("#server").click(function(){n("#server").hide();n("#client").show();r.options.serverMode=!1;n("#CloseTree").show();n("#OpenTree").hide();n("#update").trigger("click")});ut(fileRoot);a("All");window.opener||window.tinyMCEPopup||n.urlParam("field_name")||n('#itemOptions a[href$="#select"]').remove();r.options.browseOnly==!0&&(n("#file-input-container").remove(),n("#upload").remove(),n("#newfolder").remove(),n("#toolbar").remove("#rename"),n(".contextMenu .edit").remove(),n(".contextMenu .rename").remove(),n(".contextMenu .move").remove(),n(".contextMenu .replace").remove(),n(".contextMenu .delete").remove());ct();n(window).resize(ct);n("#splitter").splitter({sizeLeft:200,doSplitMouse:function(){var t=n("#fileinfo"),r=parseInt(t.css("width").replace("px",""))-50,u=parseInt(t.css("height").replace("px",""))-50,i=t.find("iframe");i.length>0&&(i.css("width",r),i.css("height",u))}});r.options.serverMode&&(n("#CloseTree").hide(),n("#home").trigger("click"));r.options.useFileTable&&n("#pen").show()}var t,fi;n.urlParam=function(n){var t=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(window.location.href);return t?t[1]:0};var ht=function(t){var i=null,r;return t=typeof t=="undefined"?"user":t,r=t=="user"?"./scripts/filemanager.config.js":"./scripts/filemanager.config.js.default",n.ajax({async:!1,url:r,dataType:"json",cache:!1,success:function(n){i=n}}),i},ei=ht("default"),r=ht(),r=n.extend({},ei,r);HEAD_included_files=[];loadCSS=function(t){if(n.inArray(t,HEAD_included_files)==-1){var i=n("<link rel='stylesheet' type='text/css' href='"+t+"'>");n("head").append(i);HEAD_included_files.push(t)}};loadJS=function(t){if(n.inArray(t,HEAD_included_files)==-1){var i=n("<script type='text/javascript' src='"+t+"'>");n("head").append(i);HEAD_included_files.push(t)}};var k=!0,f=r.options.fileConnector||"connectors/"+r.options.lang+"/filemanager."+r.options.lang,o=r.options.capabilities||["edit","select","download","rename","move","delete","replace"];n.urlParam("langCode")!=0&&oi("scripts/languages/"+n.urlParam("langCode")+".js")&&(r.options.culture=n.urlParam("langCode"));loadJS("plupload/i18n/"+r.options.culture+".js");t=[];n.ajax({url:"scripts/languages/"+r.options.culture+".js",async:!1,dataType:"json",success:function(n){t=n}});n.prompt.setDefaults({overlayspeed:"fast",show:"fadeIn",opacity:.4,persistent:!1});var ct=function(){var t=20,i,u;r.options.searchBox===!0&&(t+=33);n.urlParam("CKEditorCleanUpFuncNum")&&(t+=60);i=n(window).height()-n("#uploader").height()-t;n("#splitter, #filetree, #fileinfo, .vsplitbar").height(i);u=n("#splitter").width()-6-n("#filetree").width();n("#fileinfo").width(u)},w=function(n,t){if(t=typeof t=="undefined"?!0:!1,r.options.showFullPath==!1){if("function"==typeof displayPathDecorator)return displayPathDecorator(n.replace(fileRoot,"/"));if(n=n.replace(fileRoot,"/"),n.length>35&&t===!0){var i=n.split("/");n="/"+i[1]+"/"+i[2]+"/(...)/"+i[i.length-2]+"/"}return n}return n},d=function(t){t=="grid"?(n("#grid").addClass("ON"),n("#list").removeClass("ON")):(n("#list").addClass("ON"),n("#grid").removeClass("ON"))};var si=function(n,t,r){var u=String(r),f,e;for(i=0;i<n.length;i++)f=RegExp(n[i],"g"),e=t[i],u=u.replace(f,e);return u},g=function(n){var t="";return t=si(["Š","š","Đ","đ","Ž","ž","Č","č","Ć","ć","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ñ","Ò","Ó","Ô","Õ","Ö","Ő","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","ő","ø","ù","ú","û","ü","ý","ý","þ","ÿ","Ŕ","ŕ"," ","'","/"],["S","s","Dj","dj","Z","z","C","c","C","c","A","A","A","A","A","A","A","C","E","E","E","E","I","I","I","I","N","O","O","O","O","O","O","O","U","U","U","U","Y","B","Ss","a","a","a","a","a","a","a","c","e","e","e","e","i","i","i","i","o","n","o","o","o","o","o","o","o","u","u","u","u","y","y","b","y","R","r","_","_",""],n),r.options.chars_only_latin&&(t=t.replace(/[^_a-zA-Z0-9]/g,"")),t.replace(/[_]+/g,"_")},hi=function(n){return filename="",filename=n.lastIndexOf(".")!=-1?g(n.substr(0,n.lastIndexOf(".")))+("."+n.split(".").pop()):g(n)},lt=function(n){for(var i=parseFloat(n),r=parseFloat(1024),u=0,f=[t.bytes,t.kb,t.mb,t.gb];;){if(i<r)return i=Math.round(i*100)/100,i+f[u];i/=r;u+=1}},nt=function(t){n("#fileinfo").html("<h1>"+t+"<\/h1>");n("#newfile").attr("disabled","disabled");n("#upload").attr("disabled","disabled");n("#newfolder").attr("disabled","disabled")};var ci=function(t){return r.security.uploadPolicy=="DISALLOW_ALL"&&n.inArray(e(t),r.security.uploadRestrictions)!=-1?!0:r.security.uploadPolicy=="ALLOW_ALL"&&n.inArray(e(t),r.security.uploadRestrictions)==-1?!0:!1},cr=function(n,t){var i=n.replace(/^.*[\/\\]/g,"");return typeof t=="string"&&i.substr(i.length-t.length)==t&&(i=i.substr(0,i.length-t.length)),i},e=function(n){return n.split(".").length==1?"":n.split(".").pop().toLowerCase()},li=function(n){return n.lastIndexOf(".")!=-1?n.substring(0,n.lastIndexOf(".")):n},ai=function(t){return n.inArray(e(t),r.edit.editExt)!=-1?!0:!1},vi=function(t){return n.inArray(e(t),r.edit.editEditorExt)!=-1?!0:!1},tt=function(t){return n.inArray(e(t),r.images.imagesExt)!=-1?!0:!1},yi=function(t){return n.inArray(e(t),r.videos.videosExt)!=-1?!0:!1},it=function(t){return e(t)=="mht"&&!hr()?!1:n.inArray(e(t),r.web.webExt)!=-1?!0:!1},rt=function(t){return n.inArray(e(t),r.doc.docExt)!=-1?!0:!1},pi=function(t){return n.inArray(e(t),r.audios.audiosExt)!=-1?!0:!1},wi=function(t){var u,i,f;u=r.options.serverRoot?r.options.fileRoot+t.Path.substr(fileRoot.length,t.Path.length-fileRoot.length):"connectors/ashx/filemanager.ashx?mode=redirect&path="+encodeURIComponent(t.Path);i='<center><video id = "myVideo"  width='+r.videos.videosPlayerWidth+" height="+r.videos.videosPlayerHeight+' src="'+u+'" controls="controls" type="video/mp4">';i+='<img src="'+t.Preview+'" />';i+="<\/video><\/center>";n("#fileinfo img").remove();n("#fileinfo #preview h1").before(i);f=e(t.Filename);jwplayer("myVideo").setup({file:u,type:f,primary:"flash",startparam:"start"})},bi=function(t){var u="connectors/ashx/filemanager.ashx?mode=redirect&path="+encodeURIComponent(t.Path),i='<center><audio src="'+t.Path+'" id = "myAudio" controls="controls">',r;i+='<img src="'+t.Preview+'" />';i+="<\/audio><\/center>";n("#fileinfo img").remove();n("#fileinfo #preview h1").before(i);r=e(t.Filename);jwplayer("myAudio").setup({file:u,type:r,primary:"flash",startparam:"start"})},at=function(t){n("#fileinfo").find("td:first-child").each(function(){var r=n(this).attr("data-path"),i=n("#filetree").find('a[data-path="'+r+'"]').parent();typeof i.css("background-image")!="undefined"&&(n(this).css("background-image",i.css("background-image")),window.clearInterval(t))})},ut=function(i){n("#currentpath").val(i);n("#uploader h1").text(t.current_folder+w(i)).attr("title",w(i,!1)).attr("data-path",i);n("#newfolder").unbind().click(function(){var i=t.default_foldername,e=t.prompt_foldername+' : <input id="fname" name="fname" type="text" value="'+i+'" />',o=function(r,e){var o,h;if(r!=1)return!1;o=e.children("#fname").val();o!=""?(i=g(o),h=new Date,n.getJSON(f+"?mode=addfolder&path="+encodeURIComponent(n("#currentpath").val())+"&name="+encodeURIComponent(i)+"&time="+h.getMilliseconds(),function(i){i.Code==0?(u?ir(i.Parent,i.Name):rr(i.Parent,i.Name),s(i.Parent),n("#filetree").find('a[data-path="'+i.Parent+'/"]').click().click()):n.prompt(t.DIRECTORY_ALREADY_EXISTS)})):n.prompt(t.no_foldername)},r={};r[t.create_folder]=!0;r[t.cancel]=!1;n.prompt(e,{callback:o,buttons:r})})},vt=function(i){n("#fileinfo button").each(function(){n(this).find("span").length==0&&n(this).wrapInner("<span><\/span>")});h(i,"select")?(n("#fileinfo").find("button#select").click(function(){et(i)}).show(),(window.opener||window.tinyMCEPopup)&&(n("#preview img").attr("title",t.select),n("#preview img").click(function(){et(i)}).css("cursor","pointer"))):n("#fileinfo").find("button#select").hide();h(i,"rename")?n("#fileinfo").find("button#rename").click(function(){var t=yt(i);t.length&&n("#fileinfo > h1").text(t)}).show():n("#fileinfo").find("button#rename").hide();h(i,"move")?n("#fileinfo").find("button#move").click(function(){var t=wt(i);t.length&&n("#fileinfo > h1").text(t)}).show():n("#fileinfo").find("button#move").hide();h(i,"replace")?n("#fileinfo").find("button#replace").click(function(){pt(i)}).show():n("#fileinfo").find("button#replace").hide();h(i,"delete")?n("#fileinfo").find("button#delete").click(function(){bt(i)&&n("#fileinfo").html("<h1>"+t.select_from_left+"<\/h1>")}).show():n("#fileinfo").find("button#delete").hide();h(i,"edit")?n("#fileinfo").find("button#edit").click(function(){kt(i)}).show():n("#fileinfo").find("button#edit").hide();h(i,"download")?n("#fileinfo").find("button#download").click(function(){window.location=f+"?mode=download&path="+encodeURIComponent(i.Path)}).show():n("#fileinfo").find("button#download").hide()},ft=!0,a=function(){r.options.expandedFolder=r.options.serverMode?"":"All";n("#filetree").fileTree({root:fileRoot,datafunc:r.options.serverMode?er:fr,multiFolder:!0,folderCallback:function(n){s(n)},expandedFolder:r.options.expandedFolder,server:r.options.serverMode,after:function(){k=!0;n("#filetree").find("li a").each(function(){n(this).contextMenu({menu:y(n(this))},function(t,i){var r=n(i).attr("data-path");p(t,r)})});r.options.searchBox==!0&&(ft?n("#q").liveUpdate("#filetree ul",1).blur():n("#q").liveUpdate("#filetree ul",2).blur(),n("#search span.q-inactive").html(t.search),n("#search a.q-reset").attr("title",t.search_reset))}},function(n){b(n)})},et=function(i){var u,f;if(u=r.options.relPath!==!1?relPath+i.Path.replace(fileRoot,""):relPath+i.Path,window.opener||window.tinyMCEPopup||n.urlParam("field_name")||n.urlParam("CKEditorCleanUpFuncNum")||n.urlParam("CKEditor")){if(window.tinyMCEPopup){f=tinyMCEPopup.getWindowArg("window");f.document.getElementById(tinyMCEPopup.getWindowArg("input")).value=u;typeof f.ImageDialog!="undefined"&&(f.ImageDialog.getImageData&&f.ImageDialog.getImageData(),f.ImageDialog.showPreviewImage&&f.ImageDialog.showPreviewImage(u));tinyMCEPopup.close();return}if(n.urlParam("field_name"))parent.document.getElementById(n.urlParam("field_name")).value=u,typeof parent.tinyMCE!="undefined"&&parent.tinyMCE.activeEditor.windowManager.close(),typeof parent.$.fn.colorbox!="undefined"&&parent.$.fn.colorbox.close();else if(n.urlParam("CKEditor"))window.opener?window.opener.CKEDITOR.tools.callFunction(n.urlParam("CKEditorFuncNum"),u):(parent.CKEDITOR.tools.callFunction(n.urlParam("CKEditorFuncNum"),u),parent.CKEDITOR.tools.callFunction(n.urlParam("CKEditorCleanUpFuncNum")));else if(i.Properties.Width!=""){var e=u,o=i.Properties.Width,s=i.Properties.Height;window.opener.SetUrl(e,o,s)}else window.opener.SetUrl(u);window.opener&&window.close()}else n.prompt(t.fck_select_integration)},v=function(i){var h,o;if(i==null&&(i=n("#currentpath").val()),r.options.serverMode){var v=e(name),c=n("#filetree").find('a[data-path="'+i+'"]'),w=c.parent();i==fileRoot?a():c.click().click();s(i);r.options.showConfirmation&&n.prompt(t.successful_added_file)}else h=new Date,o=f+"?path="+encodeURIComponent(i)+"&mode=getfolder&showThumbs="+r.options.showThumbs+"&time="+h.getMilliseconds()+"&useFileTable="+r.options.useFileTable,n.urlParam("type")&&(o+="&type="+n.urlParam("type")),n.get(o,function(val){var result=eval("("+val+")"),thisNode=n("#filetree").find('a[data-path="'+i+'"]'),parentNode=thisNode.next(),ext,newNode;i==fileRoot?(parentNode=n("#filetree > ul.jqueryFileTree"),parentNode.children(".file").remove()):parentNode.children(".file").remove();parentNode=parentNode.parent();for(key in u[i])key.lastIndexOf("/")!=key.length-1&&delete u[i][key];delete result.Code;delete result.Path;for(key in result)key.lastIndexOf("/")!=key.length-1&&(u[i][key]=result[key],u[key+"/"]={},ext=e(result[key].Filename),newNode='<li class="file ext_'+ext+'"><a data-path="'+result[key].Path+'" href="#" id = "'+l.getID("id")+'"class="">'+result[key].Filename+"<\/a><\/li>",i==fileRoot?(parentNode=n("#filetree > ul.jqueryFileTree"),parentNode.append(newNode)):parentNode.children("ul").append(newNode),n("#filetree").find('li a[data-path="'+result[key].Path+'"]').attr("class","cap_edit cap_download cap_rename cap_delete").each(function(){n(this).contextMenu({menu:y(n(this))},function(t,i){var r=n(i).attr("data-path");p(t,r)})}));thisNode=i!=fileRoot?n("#filetree").find('a[data-path="'+i+'"]'):parentNode;thisNode.trigger("updateTree");s(i)})},yt=function(i){var s="",h=r.security.allowChangeExtensions?i.Filename:li(i.Filename),c=t.new_filename+' : <input id="rname" name="rname" type="text" value="'+h+'" />',l=function(o,h){var l,y,a,c,p;if(o!=1)return!1;if(rname=h.children("#rname").val(),rname!=""){if(l=rname,r.security.allowChangeExtensions||(l=hi(rname),y=e(i.Filename),y.length>0&&(l=l+"."+y)),!ci(l))return a="<p>"+t.INVALID_FILE_TYPE+"<\/p>",r.security.uploadPolicy=="DISALLOW_ALL"&&(a+="<p>"+t.ALLOWED_FILE_TYPE+r.security.uploadRestrictions.join(", ")+".<\/p>"),r.security.uploadPolicy=="ALLOW_ALL"&&(a+="<p>"+t.DISALLOWED_FILE_TYPE+r.security.uploadRestrictions.join(", ")+".<\/p>"),n("#filepath").val(""),n.prompt(a),!1;c=i.Path;i.Filename!=l&&(p=f+"?mode=rename&old="+encodeURIComponent(i.Path)+"&new="+encodeURIComponent(l),n.ajax({type:"GET",url:p,dataType:"json",async:!1,success:function(f){var o,e,h,l;f.Code==0&&(o=f["New Path"],e=f["New Name"],u?gi(c,o,e):nr(c,o,e),h=n("#preview h1").attr("title"),typeof h!="undefined"&&h==c&&n("#preview h1").text(e),n("#fileinfo").data("view")=="grid"?(n('#fileinfo img[data-path="'+c+'"]').parent().next("p").text(e),n('#fileinfo img[data-path="'+c+'"]').attr("data-path",o)):(n('#fileinfo td[data-path="'+c+'"]').text(e),n('#fileinfo td[data-path="'+c+'"]').attr("data-path",o)),n("#preview h1").html(e),i.Path=o,i.Filename=e,n("#fileinfo").find("button#edit,button#rename, button#delete, button#download").unbind(),vt(i),r.options.showConfirmation&&n.prompt(t.successful_rename),l=n("#currentpath").val(),n("#modeFileInfo").val()=="1"&&b(o));f.Code==-1&&(n.prompt(t.ERROR_RENAMING_FILE),v());f.Code==-2&&(n.prompt(t.ERROR_RENAMING_DIRECTORY),n("#update").trigger("click"));f.Code==-3&&n.prompt(t.DIRECTORY_ALREADY_EXISTS);f.Code==-4&&n.prompt(t.FILE_ALREADY_EXISTS2);s=f["New Name"]}}))}},o={};return o[t.rename]=!0,o[t.cancel]=!1,n.prompt(c,{callback:l,buttons:o}),s},pt=function(i){n("#fileR").bind("change",function(){n(this).closest("form#toolbar").submit()});n("#toolbar").attr("action",f);n("#toolbar").attr("method","post");n("#toolbar").ajaxForm({target:"#uploadresponse",beforeSubmit:function(u,f){var o=n("#fileR",f).val(),s;return o==""?!1:e(o)!=i["File Type"]?(n.prompt(t.ERROR_REPLACING_FILE+" ."+e(i.Filename)),!1):(n("#replace").attr("disabled",!0),n("#upload span").addClass("loading").text(t.loading_data),typeof FileReader!="undefined"&&typeof r.upload.fileSizeLimit!="auto"&&(s=n("#fileR",f).get(0).files[0].size,s>r.upload.fileSizeLimit*1048576)?(n.prompt("<p>"+t.file_too_big+"<\/p><p>"+t.file_size_limit+r.upload.fileSizeLimit+" "+t.mb+".<\/p>"),n("#upload").removeAttr("disabled").find("span").removeClass("loading").text(t.upload),!1):void 0)},error:function(){n("#upload").removeAttr("disabled").find("span").removeClass("loading").text(t.upload);n.prompt(t.ERROR_UPLOADING_FILE)},success:function(){var i=jQuery.parseJSON(n("#uploadresponse").find("textarea").text()),u;i.Code==0?(u=i.Path+"/"+i.Name,b(u),n("#preview").find("img").hide().fadeIn("slow"),n("ul.jqueryFileTree").find('li a[data-path="'+u+'"]').parent().hide().fadeIn("slow"),r.options.showConfirmation&&n.prompt(t.successful_replace)):n.prompt(i.Error);n("#replace").removeAttr("disabled");n("#upload span").removeClass("loading").text(t.upload)}});n("#newfilepath").val(i.Path);n("#fileR").click()},wt=function(i){var e="",o=t.move+' : <input id="rname" name="rname" type="text" value="" />',h=function(u,o){if(u!=1)return!1;if(rname=o.children("#rname").val(),rname!=""){var h=rname,l=i.Path,c=f+"?mode=move&old="+encodeURIComponent(i.Path)+"&new="+encodeURIComponent(h)+"&root="+encodeURIComponent(fileRoot);n.ajax({type:"GET",url:c,dataType:"json",async:!1,success:function(i){if(i.Code==0){var u=i["New Path"],f=i["New Name"];fullexpandedFolder=u;a();s(u);r.options.showConfirmation&&n.prompt(t.successful_moved)}else n.prompt(i.Error);e=u+f}})}},u={};return u[t.move]=!0,u[t.cancel]=!1,n.prompt(o,{callback:h,buttons:u}),e},bt=function(i){var e=!1,s=t.confirmation_delete,h=function(o){if(o!=1)return!1;var s=new Date,h=f+"?mode=delete&path="+encodeURIComponent(i.Path)+"&time="+s.getMilliseconds(),c=i.Path.split("/").reverse().slice(1).reverse().join("/")+"/";n.ajax({type:"GET",url:h,dataType:"json",async:!1,success:function(i){var o;if(i.Code==0){if(u){var f=i.Path,h=f.substr(0,f.length-1),s=h.substr(0,h.lastIndexOf("/")+1);delete u[f];u[s][f]?delete u[s][f]:delete u[s][f.substr(0,f.length-1)]}tr(i.Path);o=i.Path.substring(0,i.Path.length-1);o=o.substr(0,o.lastIndexOf("/")+1);n("#uploader h1").text(t.current_folder+w(o)).attr("title",w(o,!1)).attr("data-path",o);e=!0;r.options.showConfirmation&&n.prompt(t.successful_delete);n("#filetree").find('a[data-path="'+s+'/"]').click().click()}else e=!1,n.prompt(i.Error)}})},o={};return o[t.yes]=!0,o[t.no]=!1,n.prompt(s,{callback:h,buttons:o}),e},kt=function(i){return isEdited=!1,n("#fileinfo").find("h1").append(' <a id="edit-file" href="#" title="'+t.edit+'"><span>'+t.edit+"<\/span><\/a>"),n("#edit-file").click(function(){n(this).hide();var r=new Date,u=f+"?mode=editfile&path="+encodeURIComponent(i.Path)+"&time="+r.getMilliseconds();n.getJSON(u,function(r){var e;if(r.Code==-1){n.prompt(t.ERROR_RENAMING_FILE);v();return}if(r.Code==-2){n.prompt(t.ERROR_RENAMING_DIRECTORY);n("#update").trigger("click");return}if(r.Code==0){var s=r.url,h=r.fileId,o=n("#fileinfo"),c=parseInt(o.css("width").replace("px",""))-50,l=parseInt(o.css("height").replace("px",""))-50,u='<form id="edit-form">';u+='<input type="hidden" name="mode" value="savefile" />';u+='<input type="hidden" name="fileId" value="'+h+'" />';u+='<input type="hidden" name="path" value="'+i.Path+'" />';u+='<button id="edit-cancel" class="edition" class="button" type="button">'+t.quit_editor+"<\/button>";u+='<button id="edit-save" class="edition" class="button" type="button">'+t.save+"<\/button>";u+="<\/form>";n("#preview").find("img").hide();n("#preview").prepend(u).hide().fadeIn();e=n("#fileinfo").find("iframe")[0].src;n("#fileinfo").find("iframe").attr("src",s);n("#edit-cancel").click(function(){n("#preview").find("form#edit-form").hide();n("#preview").find("img").fadeIn();n("#edit-file").show();n("#fileinfo").find("iframe").attr("src",e)});n("#edit-save").click(function(){var i=n("#edit-form").serializeArray();n.ajax({type:"POST",url:f,dataType:"json",data:i,async:!1,success:function(i){i.Code==0?(isEdited=!0,n.prompt(t.successful_edit),n("#preview").find("form#edit-form").hide(),n("#preview").find("img").fadeIn(),n("#edit-file").show(),n("#fileinfo").find("iframe").attr("src",e)):(isEdited=!1,n.prompt(i.Error))}})})}})}),isEdited},ki=function(i){return isEdited=!1,n("#fileinfo").find("h1").append(' <a id="edit-file" href="#" title="'+t.edit+'"><span>'+t.edit+"<\/span><\/a>"),n("#edit-file").click(function(){n("#fileinfo").find("iframe").hide();n(this).hide();var u=new Date,o=f+"?mode=editfileEditor&path="+encodeURIComponent(i.Path)+"&time="+u.getMilliseconds();n.getJSON(o,function(u){var s,o;if(u.Code==-1){n.prompt(t.ERROR_RENAMING_FILE);v();return}if(u.Code==-2){n.prompt(t.ERROR_RENAMING_DIRECTORY);n("#update").trigger("click");return}if(u.Code==0){s="";for(str in u.Content)s+=u.Content[str]+"\r\n";s=s.substr(0,s.length-1);o='<form id="edit-form">';o+='<textarea id="edit-content" name="content" style="overflow:auto">'+s+"<\/textarea>";o+='<input type="hidden" name="mode" value="savefileEditor" />';o+='<input type="hidden" name="path" value="'+i.Path+'" />';o+='<button id="edit-cancel" class="edition" class="button" type="button">'+t.quit_editor+"<\/button>";o+='<button id="edit-save" class="edition" class="button" type="button">'+t.save+"<\/button>";o+="<\/form>";n("#preview").find("img").hide();n("#preview").prepend(o).hide().fadeIn();n("#edit-cancel").click(function(){n("#preview").find("form#edit-form").hide();n("#preview").find("img").fadeIn();n("#edit-file").show();n("#fileinfo").find("iframe").show();n("#fileinfo").find("iframe")[0].src=n("#fileinfo").find("iframe")[0].src});n("#edit-save").click(function(){var r=codeMirrorEditor.getValue(),i;n("textarea#edit-content").val(r);i=n("#edit-form").serializeArray();n.ajax({type:"POST",url:f,dataType:"json",data:i,async:!1,success:function(i){i.Code==0?(isEdited=!0,n.prompt(t.successful_edit),n("#preview").find("form#edit-form").hide(),n("#preview").find("img").fadeIn(),n("#edit-file").show(),n("#fileinfo").find("iframe").show(),n("#fileinfo").find("iframe")[0].src=n("#fileinfo").find("iframe")[0].src):(isEdited=!1,n.prompt(i.Error))}})});codeMirrorEditor=instantiateCodeMirror(e(i.Path),r)}})}),isEdited},di=function(t,i,e){var h=new Date,o=f+"?path="+encodeURIComponent(t)+"&mode=getfolder&showThumbs="+r.options.showThumbs+"&time="+h.getMilliseconds()+"&useFileTable="+r.options.useFileTable;n.urlParam("type")&&(o+="&type="+n.urlParam("type"));n.get(o,function(val){var data=eval("("+val+")");u[t]=data;u[t+i+"/"]={};e(t,i);s(t)})},gi=function(t,i,r){var f,o,s,e,c,h;for(key in u){f=key.replace(t,i);s=u[key];delete u[key];u[f]=s;for(key2 in u[f])o=key2.replace(t,i),s=u[f][key2],delete u[f][key2],u[f][o]=s,u[f][o].Path=u[f][o].Path.replace(t,i),u[f][o].Preview=u[f][o].Preview.replace(t,i),e=u[f][o].Path,e.substr(e.length-1,e.length)=="/"&&(e=e.substr(0,e.length-1)),c=e.substr(e.lastIndexOf("/")+1,e.length),u[f][o].Filename=c}h=n("#filetree").find('a[data-path="'+t+'"]');h.attr("data-path",i).text(r);h.parent().find("a").each(function(){var r=n(this).attr("data-path");r=r.replace(t,i);n(this).attr("data-path",r)})},nr=function(t,i,r){var u=n("#filetree").find('a[data-path="'+t+'"]'),f=u.parent().parent().prev("a");u.attr("data-path",i).text(r);f.length==0?a():f.click().click()},tr=function(t){if(n("#filetree").find('a[data-path="'+t+'"]').parent().fadeOut("slow",function(){n(this).remove()}),n("#uploader h1").attr("data-path")==t){var i=t.split("/"),r=i.slice(0,length-2).join("/")+"/";s(r)}n("#fileinfo").data("view")=="grid"?n('#contents img[data-path="'+t+'"]').parent().parent().fadeOut("slow",function(){n(this).remove()}):n("table#contents").find('td[data-path="'+t+'"]').parent().fadeOut("slow",function(){n(this).remove()});n("#preview").length&&s(t.substr(0,t.lastIndexOf("/")+1))},ir=function(i,u){function f(i,u){var f='<li class="directory collapsed"><a data-path="'+i+u+'/" href="#" id = "'+l.getID("id")+'">'+u+'<\/a><ul class="jqueryFileTree" style="display: block;"><\/ul><\/li>',e=n("#filetree").find('a[data-path="'+i+'"]');i!=fileRoot?e.next("ul").prepend(f).prev("a").trigger("updateTree"):(n("#filetree > ul").prepend(f),n("#filetree").trigger("updateTree"));n("#filetree").find('li a[data-path="'+i+u+'/"]').attr("class","cap_rename cap_delete").each(function(){n(this).contextMenu({menu:y(n(this))},function(t,i){var r=n(i).attr("data-path");p(t,r)})});r.options.showConfirmation&&n.prompt(t.successful_added_folder)}di(i,u,f)},rr=function(i,u){var f='<li class="directory collapsed"><a data-path="'+i+u+'/" href="#" id = "'+l.getID("id")+'">'+u+'<\/a><ul class="jqueryFileTree" style="display: block;"><\/ul><\/li>',e=n("#filetree").find('a[data-path="'+i+'"]');i!=r.options.fileRoot?(e.next("ul").prepend(f).prev("a").click().click(),e.next("ul").prepend(f).prev("a").trigger("updateTree")):(n("#filetree > ul").prepend(f),n("#filetree").find('li a[data-path="'+i+u+'/"]').attr("class","cap_rename cap_delete").click(function(){s(i+u+"/")}).each(function(){n(this).contextMenu({menu:y(n(this))},function(t,i){var r=n(i).attr("data-path");p(t,r)})}),n("#filetree").trigger("updateTree"));r.options.showConfirmation&&n.prompt(t.successful_added_folder)},ot=function(t){t.lastIndexOf("/")==t.length-1?(s(t),n("#filetree").find('a[data-path="'+t+'"]').click()):b(t)};var dt=function(i,r,u){var s,e,o;s=n("#fileinfo").data("view")=="grid"?n("#fileinfo").find('img[data-path="'+u.Path+'"]').parent():n("#fileinfo").find('td[data-path="'+u.Path+'"]').parent();switch(i){case"select":et(u);break;case"download":e=new Date;url=f+"?mode=downloadCheck&path="+encodeURIComponent(u.Path)+"&user_id="+c("user_id")+"&time="+e.getMilliseconds();n.ajax({type:"GET",url:url,dataType:"json",async:!1,cache:!1,success:function(i){if(i.Code==0&&(e=new Date,window.location=f+"?mode=download&path="+encodeURIComponent(u.Path)+"&user_id="+c("user_id")+"&time="+e.getMilliseconds()),i.Code==-1){n.prompt(t.ERROR_RENAMING_FILE);var r=i.Path.substr(0,i.Path.lastIndexOf("/")+1);v(r)}}});break;case"rename":o=yt(u);break;case"replace":pt(u);break;case"move":o=wt(u);break;case"delete":bt(u)}},p=function(i,r){var o=r.substr(0,r.lastIndexOf("/")+1),e,s;r.lastIndexOf("/")==r.length-1&&(e=r.substr(0,r.length-1),o=e.substr(0,e.lastIndexOf("/")+1));u?(data=u[o][r],dt(i,r,data)):(s=new Date,n.get(f+"?mode=getinfo&path="+encodeURIComponent(r)+"&time="+s.getMilliseconds(),function(data){var data=eval("("+data+")"),currentpath;data.Code==-2&&(n.prompt(t.ERROR_RENAMING_DIRECTORY),n("#update").trigger("click"));data.Code==-1&&(n.prompt(t.ERROR_RENAMING_FILE),currentpath=data.Path.substr(0,data.Path.lastIndexOf("/")+1),n("#filetree").find('a[data-path="'+currentpath+'"]').click().click());data.Code==0&&dt(i,r,data)}))},gt=function(i,u){var a=u.substr(0,u.lastIndexOf("/")+1),f='<div id="preview"><img /><h1><\/h1><dl><\/dl><\/div>',c,e,h;if(it(i.Filename)||rt(i.Filename)){var l=n("#fileinfo"),v=parseInt(l.css("width").replace("px",""))-50,y=parseInt(l.css("height").replace("px",""))-50;f='<div id="preview"><iframe width="'+v+'" height="'+y+'" scrolling="auto"><\/iframe><h1><\/h1><dl><\/dl><\/div>'}tt(i.Filename)&&(f='<div id="preview"><img /><h1><\/h1><dl><\/dl><\/div>');f+='<form id="toolbar">';f+='<button id="parentfolder" class="button">'+t.parentfolder+"<\/button>";n.inArray("select",o)!=-1&&(n.urlParam("CKEditor")||window.opener||window.tinyMCEPopup||n.urlParam("field_name"))&&(f+='<button id="select" class="button" name="select" type="button" value="Select">'+t.select+"<\/button>");n.inArray("download",o)!=-1&&(f+='<button class="button" id="download" name="download" type="button" value="Download">'+t.download+"<\/button>");n.inArray("rename",o)!=-1&&r.options.browseOnly!=!0&&(f+='<button class="button" id="rename" name="rename" type="button" value="Rename">'+t.rename+"<\/button>");n.inArray("move",o)!=-1&&r.options.browseOnly!=!0&&(f+='<button class="button" id="move" name="move" type="button" value="Move">'+t.move+"<\/button>");n.inArray("delete",o)!=-1&&r.options.browseOnly!=!0&&(f+='<button class="button" id="delete" name="delete" type="button" value="Delete">'+t.del+"<\/button>");f+="<\/form>";n("#fileinfo").html(f);n("#parentfolder").click(function(){s(a)});i.Code==0?(n("#fileinfo").find("h1").text(i.Filename).attr("title",u),it(i.Filename)&&(e="connectors/ashx/filemanager.ashx?path="+encodeURIComponent(u)+"&mode=redirect&view=true",n("#fileinfo").find("h1").html('<a href="#" onclick="window.open(\''+e+"','_blank'); return false;\">"+i.Filename+"<\/a>"),n("#fileinfo").find("iframe").attr("src",e)),rt(i.Filename)&&(c=location.protocol+"//"+location.host+"/Filemanager/connectors/ashx/filemanager.ashx?path="+u+"&mode=redirect&view=true",e="http://docs.google.com/gview?url="+encodeURIComponent(c)+"&embedded=true",n("#fileinfo").find("h1").html('<a href="#" onclick="window.open(\'http://docs.google.com/viewer?url='+encodeURIComponent(c)+"','_blank'); return false;\">"+i.Filename+"<\/a>"),n("#fileinfo").find("iframe").attr("src",e)),tt(i.Filename)&&(e="connectors/ashx/filemanager.ashx?path="+encodeURIComponent(u)+"&mode=redirect&view=true",n("#fileinfo").find("img").attr("src",e)),tt(i.Filename)||it(i.Filename)||rt(i.Filename)||i.Preview.indexOf("connectors/ashx/filemanager.ashx")==-1&&(e=i.Preview,n("#fileinfo").find("img").attr("src",e)),yi(i.Filename)&&r.videos.showVideoPlayer==!0&&wi(i),pi(i.Filename)&&r.audios.showAudioPlayer==!0&&bi(i),ai(i.Filename)&&r.edit.enabled==!0&&kt(i),vi(i.Filename)&&r.edit.enabled==!0&&ki(i),h="",i.Properties.Width&&i.Properties.Width!=""&&(h+="<dt>"+t.dimensions+"<\/dt><dd>"+i.Properties.Width+"x"+i.Properties.Height+"<\/dd>"),i.Properties["Date Created"]&&i.Properties["Date Created"]!=""&&(h+="<dt>"+t.created+"<\/dt><dd>"+i.Properties["Date Created"]+"<\/dd>"),i.Properties["Date Modified"]&&i.Properties["Date Modified"]!==""&&(h+="<dt>"+t.modified+"<\/dt><dd>"+i.Properties["Date Modified"]+"<\/dd>"),(i.Properties.Size||parseInt(i.Properties.Size)==0)&&(h+="<dt>"+t.size+"<\/dt><dd>"+lt(i.Properties.Size)+"<\/dd>"),i.Properties.User&&i.Properties.User!=""&&(h+="<dt>"+t.user+"<\/dt><dd>"+i.Properties.User+"<\/dd>"),i.Properties.UserCreate&&i.Properties.UserCreate!=""&&(h+="<dt>"+t.user_create_document+"<\/dt><dd>"+i.Properties.UserCreate+"<\/dd>"),i.Properties.DateDocument&&i.Properties.DateDocument!=""&&(h+="<dt>"+t.date_document+"<\/dt><dd>"+i.Properties.DateDocument+"<\/dd>"),n("#fileinfo").find("dl").html(h),ni(),vt(i)):n.prompt(i.Error)},ni=function(){n("img").error(function(){var r=n(this).attr("src"),i;r.indexOf("mode=redirect")!=-1?(i="/Filemanager/connectors/ashx/filemanager.ashx?currentpath="+encodeURIComponent(n(this).attr("src"))+"&mode=checkPath",n(this).attr("src","./images/fileicons/default.png"),n.ajax({type:"GET",url:i,dataType:"json",async:!1,cache:!1,success:function(i){i.Code==-2&&(n.prompt(t.ERROR_RENAMING_DIRECTORY),n("#update").trigger("click"));i.Code==-1&&(n.prompt(t.ERROR_RENAMING_FILE),v())}})):n(this).attr("src","./images/fileicons/default.png")})},ti=function(i){var f,u,e,s,c,l,a,v;if(n("#modeFileInfo").val("0"),f="",i.Code=="-1"){nt(i.Error);return}if(i)if(n("#fileinfo").data("view")=="grid"){f+='<ul id="contents" class="grid">';for(key in i){u=i[key].Properties;e="";for(cap in o)h(i[key],o[cap])&&(e+=" cap_"+o[cap]);s=64;c=u.Width;c>1&&c<s&&(s=c);title=r.options.showTitleAttr?' title="'+i[key].Path+'"':"";l="";i[key].Properties.User&&i[key].Properties.User!=""&&(l=i[key].Properties.User);a=i[key].Preview;i[key].Preview.indexOf(r.icons.path)==-1&&(a+="&view=false");f+='<li class="'+e+'"'+title+'"><div class="clip"><img src="'+a+'" width="'+s+'" alt="'+i[key].Path+'" data-path="'+i[key].Path+'" /><\/div><p>'+i[key].Filename+"<\/p><p>"+l+"<\/p>";u.Width&&u.Width!=""&&(f+='<span class="meta dimensions">'+u.Width+"x"+u.Height+"<\/span>");u.Size&&u.Size!==""&&(f+='<span class="meta size">'+u.Size+"<\/span>");u["Date Created"]&&u["Date Created"]!=""&&(f+='<span class="meta created">'+u["Date Created"]+"<\/span>");u["Date Modified"]&&u["Date Modified"]!=""&&(f+='<span class="meta modified">'+u["Date Modified"]+"<\/span>");f+="<\/li>"}f+="<\/ul>"}else{f+='<table id="contents" class="list">';f+='<thead><tr><th class="headerSortDown"><span>'+t.name+"<\/span><\/th><th><span>"+t.size+"<\/span><\/th><th><span>"+t.modified+"<\/span><\/th>"+(r.options.useFileTable?'<th style="color:green"><span>'+t.user+"<\/span><\/th>":"")+(r.options.useFileTable?'<th style="color:green"><span>'+t.user_create_document+"<\/span><\/th>":"")+(r.options.useFileTable?'<th style="color:green"><span>'+t.date_document+"<\/span><\/th>":"")+"<\/tr><\/thead>";f+="<tbody>";for(key in i){var w=i[key].Path,u=i[key].Properties,e="";title=r.options.showTitleAttr?' title="'+i[key].Path+'"':"";for(cap in o)h(i[key],o[cap])&&(e+=" cap_"+o[cap]);f+='<tr class="'+e+'">';f+='<td data-path="'+i[key].Path+'"'+title+'">'+i[key].Filename+"<\/td>";f+=u.Size&&u.Size!=""?'<td><abbr title="'+u.Size+'">'+lt(u.Size)+"<\/abbr><\/td>":"<td><\/td>";f+=u["Date Modified"]&&u["Date Modified"]!=""?"<td>"+u["Date Modified"]+"<\/td>":"<td><\/td>";f+=u.User&&u.User!=""?"<td>"+u.User+"<\/td>":"<td><\/td>";f+=u.UserCreate&&u.UserCreate!=""?"<td>"+u.UserCreate+"<\/td>":"<td><\/td>";f+=u.DateDocument&&u.DateDocument!=""?"<td>"+u.DateDocument+"<\/td>":"<td><\/td>";f+="<\/tr>"}f+="<\/tbody>";f+="<\/table>"}else f+="<h1>"+t.could_not_retrieve_folder+"<\/h1>";n("#fileinfo").html(f);ni();n("#fileinfo").data("view")=="grid"?n("#fileinfo").find("#contents li").click(function(){var t=n(this).find("img").attr("data-path");ot(t)}).each(function(){n(this).contextMenu({menu:y(n(this))},function(t,i){var r=n(i).find("img").attr("data-path");p(t,r)})}):(n("#fileinfo tbody tr").click(function(){var t=n("td:first-child",this).attr("data-path");ot(t)}).each(function(){n(this).contextMenu({menu:y(n(this))},function(t,i){var r=n("td:first-child",i).attr("data-path");p(t,r)})}),n("#fileinfo").find("table").tablesorter({textExtraction:function(t){return n(t).find("abbr").size()?n(t).find("abbr").attr("title"):t.innerHTML}}),at(),v=setInterval(function(){at(v)},300))},b=function(i){var r,e;n("#modeFileInfo").val("1");r=i.substr(0,i.lastIndexOf("/")+1);ut(r);u?(data=u[r][i],gt(data,i)):(e=new Date,n.getJSON(f+"?mode=getinfo&path="+encodeURIComponent(i)+"&time="+e.getMilliseconds(),function(r){if(r.Code==-2){n.prompt(t.ERROR_RENAMING_DIRECTORY);n("#update").trigger("click");return}if(r.Code==-1){n.prompt(t.ERROR_RENAMING_FILE);var u=r.Path.substr(0,r.Path.lastIndexOf("/")+1);n("#filetree").find('a[data-path="'+u+'"]').click().click();return}r.Code==0&&gt(r,i)}))},s=function(t){if(ut(t),n("#fileinfo").html('<img id="activity" src="images/wait30trans.gif" width="30" height="30" />'),u)u[t]||(u[t]={}),data=u[t],ti(data);else{var e=new Date,i=f+"?path="+encodeURIComponent(t)+"&mode=getfolder&showThumbs="+r.options.showThumbs+"&time="+e.getMilliseconds()+"&useFileTable="+r.options.useFileTable;n.urlParam("type")&&(i+="&type="+n.urlParam("type"));n.getJSON(i,function(n){ti(n)})}};var l=new ur("id"),ii=function(n,i){var u="",f;if(n.Code=="-1"){nt(n.Error);return}if(n){u+='<ul class="jqueryFileTree" style="display: none;">';for(key in n){f="";for(cap in o)h(n[key],o[cap])&&(f+=" cap_"+o[cap]);n[key]["File Type"]=="dir"?u+='<li class="directory collapsed"><a href="#" id = "'+l.getID("id")+'" class="'+f+'" data-path="'+n[key].Path+'">'+n[key].Filename+"<\/a><\/li>":r.options.listFiles&&(u+='<li class="file ext_'+n[key]["File Type"].toLowerCase()+'"><a href="#" id = "'+l.getID("id")+'" class="'+f+'" data-path="'+n[key].Path+'" user="'+n[key].Properties.User+'">'+n[key].Filename+"<\/a><\/li>")}u+="<\/ul>"}else u+="<h1>"+t.could_not_retrieve_folder+"<\/h1>";i(u)},u,ri=function(n){for(key in n)u[key]=n[key].PathChild,ri(u[key])},fr=function(t,i){var o=new Date,e=f+"?path="+encodeURIComponent(t)+"&mode=getfolderList&showThumbs="+r.options.showThumbs+"&time="+o.getMilliseconds()+"&update="+Update+"&useFileTable="+r.options.useFileTable;n.urlParam("type")&&(e+="&type="+n.urlParam("type"));u?t&&ii(u[t],i):n.get(e,function(val){Update=!1;var data=eval("("+val+")");u={};dataNew={};dataNewChild={};dataNewChild.PathChild=data;dataNew[fileRoot]=dataNewChild;ri(dataNew);ot(fileRoot);ii(u[fileRoot],i)})},er=function(i,u){var s=new Date,e=f+"?path="+encodeURIComponent(i)+"&mode=getfolder&showThumbs="+r.options.showThumbs+"&time="+s.getMilliseconds()+"&useFileTable="+r.options.useFileTable;n.urlParam("type")&&(e+="&type="+n.urlParam("type"));n.getJSON(e,function(n){var i="",f;if(n.Code=="-1"){nt(n.Error);return}if(n){i+='<ul class="jqueryFileTree" style="display: none;">';for(key in n){f="";for(cap in o)h(n[key],o[cap])&&(f+=" cap_"+o[cap]);n[key]["File Type"]=="dir"?i+='<li class="directory collapsed"><a href="#" id = "'+l.getID("id")+'" class="'+f+'" data-path="'+n[key].Path+'">'+n[key].Filename+"<\/a><\/li>":r.options.listFiles&&(i+='<li class="file ext_'+n[key]["File Type"].toLowerCase()+'"><a href="#" id = "'+l.getID("id")+'" class="'+f+'" data-path="'+n[key].Path+'">'+n[key].Filename+"<\/a><\/li>")}i+="<\/ul>"}else i+="<h1>"+t.could_not_retrieve_folder+"<\/h1>";u(i)})};Update=!1;n(function(){if(c("fileRoot")!=undefined&&(r.options.fileRoot=c("fileRoot")),c("serverRoot")!=undefined&&(r.options.serverRoot=eval(c("serverRoot"))),c("serverMode")!=undefined&&(r.options.serverMode=eval(c("serverMode"))),c("useFileTable")!=undefined&&(r.options.useFileTable=eval(c("useFileTable"))),r.options.serverRoot){var url="connectors/ashx/filemanager.ashx?path="+encodeURIComponent(r.options.fileRoot)+"&mode=getRootPath";n.get(url,function(n){fileRoot=n;ui()})}else fileRoot=r.options.fileRoot,ui()});fi=document.documentElement;fi.setAttribute("data-useragent",navigator.userAgent)})(jQuery);
/*
//# sourceMappingURL=filemanager.min.js.map
*/